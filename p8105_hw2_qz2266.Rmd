---
title: "p8105_hw2_qz2266"
author: "Qing Zhou"
date: "2022-10-05"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, message = FALSE)
```

```{r libraries}
library(tidyverse)
library(readxl)
```

# Problem 2

## Read and clean the Mr. Trash Wheel sheet.

```{r}
mr_trash_wheel = 
  read_excel("data/Trash Wheel Collection data-new.xlsx", 
  sheet = "Mr. Trash Wheel", 
  range =  cell_cols("A:N"), skip = 1) %>% 
  
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(round(sports_balls, digits = 0)),year = as.integer(year))
  
```

## Read and clean the Professor Trash Wheel sheet.

```{r}
prof_trash_wheel = 
  read_excel("data/Trash Wheel Collection data-new.xlsx", 
  sheet = "Professor Trash Wheel", 
  range =  cell_cols("A:M"), skip = 1) %>% 
  
  janitor::clean_names() %>% 
  drop_na(dumpster) 
```

## Add a new variable to keep track of which Trash Wheel is which.

```{r}
mr_trash_wheel_new = mutate(mr_trash_wheel, trash_wheel_type = "Mr.") %>%
                     relocate(trash_wheel_type, .before = dumpster) 
                     
prof_trash_wheel_new = mutate(prof_trash_wheel, trash_wheel_type = "Prof.") %>% 
                       relocate(trash_wheel_type, .before = dumpster) 
```                       

## Combine two datasets

```{r}
trash_wheel = 
  bind_rows(mr_trash_wheel_new, prof_trash_wheel_new)
```

## Data discription

The original mr_trash_wheel data set has `r ncol(mr_trash_wheel)` variables, including `r colnames(mr_trash_wheel)`, and `r nrow(mr_trash_wheel)` observations. 
The original prof_trash_wheel data set has `r ncol(prof_trash_wheel)` variables, including `r colnames(prof_trash_wheel)`, and `r nrow(prof_trash_wheel)` observations. 
As for the combined data set, there are `r ncol(trash_wheel)` variables, and `r nrow(trash_wheel)` observations. Key variables are measurements of trash collected, including weight,volume and trash type, such as plastic bottles, cigarette butts, grocery bags -- in addition to the date of the collection.


The total weight of trash collected by Professor Trash Wheel is `r round(sum(pull(prof_trash_wheel, weight_tons), na.rm = TRUE))` tons. Similarly, if we use the combined data set, it would be `r round(sum(pull(filter(trash_wheel, trash_wheel_type == 'Prof.'),  weight_tons), na.rm = TRUE))` tons.


The total number of sports balls collected by Mr. Trash Wheel in 2020 is `r round(sum(pull(filter(mr_trash_wheel, year == 2020), sports_balls), na.rm = TRUE))`. If we use the combined data set, the number is the same. It is `r round(sum(pull(filter(trash_wheel, trash_wheel_type == 'Mr.' & year == 2020),  sports_balls), na.rm = TRUE))`.


# Problem 3

## Clean the data in pols-month.csv.

```{r read_pols_month}
pols = read_csv("data/fivethirtyeight_datasets/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  
  separate(col = mon, into = c("year", "month", "day")) %>%
  mutate(
    year = as.integer(year), 
    day = as.integer(day),
    month = month.name[as.integer(month)]) %>%
  
  mutate(president = recode(prez_dem, `1` = "dem", `0` = "gop")) %>%
  select(-prez_gop, -prez_dem, -day)
```

## Clean the data in snp.csv.

```{r read_snp}

library(lubridate)

snp = read_csv("data/fivethirtyeight_datasets/fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  
  mutate(date = lubridate::parse_date_time2(date, orders = "mdy", cutoff_2000 = 23)) %>%
  separate(col = date, into = c("year", "month", "day")) %>%
  mutate(
    year = as.integer(year), 
    day = as.integer(day)) %>%
  arrange(year, month) %>%
  mutate(month = month.name[as.integer(month)]) %>%
  
  select(year, month, day, close)
```

